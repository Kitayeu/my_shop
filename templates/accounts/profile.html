{% extends 'shops/base.html' %}

{% block title %}Account{% endblock title %}

{% block content %}

    <br>

    {% if messages %}
        <div>
            {% for message in messages %}
            {{ message }}
            <a href="" class="close">x</a>
            {% endfor %}
        </div>
    {% endif %}

    <div>
        <h2>
            Profile
        </h2>
        <form action="" method="post">
            {% csrf_token %}

            <div class="row">

                <div>
                    <label for="first_name">First name</label>
                    {{ user_form.first_name }}
                </div>

                <div>
                    <label for="last_name">Last name</label>
                    {{ user_form.last_name }}
                </div>

                <div>
                    <label for="email">Email</label>
                    {{ user_form.email }}
                </div>

                <div>
                    <label for="phone_number">Phone number</label>
                    {{ profile_form.phone_number }}
                </div>

            </div>

            <br>

            <hr>

            <div class="row">

                <div>
                    <label for="address">Address</label>
                    {{ profile_form.address }}
                </div>

                <div>
                    <label for="postal_code">Postal code</label>
                    {{ profile_form.postal_code }}
                </div>

                <div>
                    <label for="city">City</label>
                    {{ profile_form.city }}
                </div>

                <div>
                    <label for="country">Country</label>
                    {{ profile_form.country }}
                </div>

            </div>

            <hr>

            <div class="row">
                <button type="submit" data-toggle="tooltip" data-placement="top"
                        title="Fill in new details and click 'Update profile'">
                    Update profile
                </button>
            </div>

            <hr>

            <h3>Your orders:</h3>
            <table>
                {% for order in request.user.orders.all %}
                    <tr>
                        <td>
                            <a href="{{ order.get_absolute_url }}">
                                {{ order.id }}
                            </a>
                        </td>

                        <td>{{ order.created|date }}</td>
                        <td>
                            ${{ order.get_total_cost|floatformat:2 }}
                        </td>

                        <td>
                            <a href="{% url 'orders:customer_invoice_pdf' order.id %}" target="_blank">
                                <i></i>
                                Invoice {{ order.id }}
                            </a>
                        </td>

                        <td>{{ order.status }}</td>
                    </tr>

                {% empty %}

                    <tr>
                        No orders yet
                    </tr>

                {% endfor %}

            </table>

        </form>
    </div>

{% endblock content %}